<view class="register-page">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">ğŸ‘¤ äººå‘˜ç™»è®°</text>
    <text class="page-desc">è¯·å¡«å†™æ‚¨çš„åŸºæœ¬ä¿¡æ¯</text>
  </view>

  <!-- è¡¨å•åŒºåŸŸ -->
  <view class="form-container">
    
    <!-- å§“å -->
    <view class="form-item">
      <text class="form-label">å§“å <text class="required">*</text></text>
      <input 
        class="form-input {{nameError ? 'error' : ''}}"
        placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å" 
        value="{{formData.name}}"
        bindinput="onInputName"
        maxlength="20"
      />
      <view wx:if="{{nameError}}" class="error-tip">{{nameError}}</view>
    </view>

    <!-- æ€§åˆ«é€‰æ‹© -->
    <view class="form-item">
      <text class="form-label">æ€§åˆ« <text class="required">*</text></text>
      <view class="gender-buttons">
        <view 
          class="gender-btn {{formData.gender === 'male' ? 'active' : ''}}" 
          bindtap="onSelectGender" 
          data-gender="male"
        >
          <text class="gender-icon">ğŸ‘¨</text>
          <text class="gender-text">ç”·</text>
        </view>
        <view 
          class="gender-btn {{formData.gender === 'female' ? 'active' : ''}}" 
          bindtap="onSelectGender" 
          data-gender="female"
        >
          <text class="gender-icon">ğŸ‘©</text>
          <text class="gender-text">å¥³</text>
        </view>
      </view>
      <view wx:if="{{genderError}}" class="error-tip">{{genderError}}</view>
    </view>

    <!-- å¹´é¾„ -->
    <view class="form-item">
      <text class="form-label">å¹´é¾„ <text class="required">*</text></text>
      <input 
        class="form-input {{ageError ? 'error' : ''}}"
        type="number"
        placeholder="è¯·è¾“å…¥å¹´é¾„" 
        value="{{formData.age}}"
        bindinput="onInputAge"
        maxlength="3"
      />
      <view wx:if="{{ageError}}" class="error-tip">{{ageError}}</view>
    </view>

    <!-- æ‰‹æœºå· -->
    <view class="form-item">
      <text class="form-label">æ‰‹æœºå· <text class="required">*</text></text>
      
      <view class="phone-container">
        <input 
          class="form-input phone-input {{phoneError ? 'error' : ''}}"
          type="number"
          placeholder="{{formData.isWxPhone ? 'å·²é€šè¿‡å¾®ä¿¡è·å–' : 'è¯·è¾“å…¥æ‰‹æœºå·'}}"
          value="{{formData.phone}}"
          bindinput="onInputPhone"
          maxlength="11"
          disabled="{{formData.isWxPhone}}"
        />
        
        <!-- å¾®ä¿¡è·å–æŒ‰é’® -->
        <button 
          class="wx-get-btn {{formData.isWxPhone ? 'success' : ''}}" 
          open-type="getPhoneNumber" 
          bindgetphonenumber="onGetPhoneNumber"
          disabled="{{formData.isWxPhone}}"
        >
          {{formData.isWxPhone ? 'âœ“å·²è·å–' : 'å¾®ä¿¡è·å–'}}
        </button>
      </view>
      
      <view wx:if="{{phoneError}}" class="error-tip">{{phoneError}}</view>
      
      <!-- æ‰‹æœºå·æ¥æºæç¤º -->
      <view class="phone-source" wx:if="{{formData.phone && !phoneError}}">
        <text class="source-text {{formData.isWxPhone ? 'wx-source' : 'manual-source'}}">
          {{formData.isWxPhone ? 'âœ“ å¾®ä¿¡è·å–' : 'ğŸ“± æ‰‹åŠ¨è¾“å…¥'}}
        </text>
        <text class="clear-phone" bindtap="onClearPhone">é‡æ–°è¾“å…¥</text>
      </view>
    </view>

    <!-- çŸ­ä¿¡éªŒè¯ç ï¼ˆä»…æ‰‹åŠ¨è¾“å…¥æ—¶æ˜¾ç¤ºï¼‰ -->
    <view wx:if="{{formData.phone && !formData.isWxPhone}}" class="form-item">
      <text class="form-label">éªŒè¯ç  <text class="required">*</text></text>
      <view class="sms-container">
        <input 
          class="form-input sms-input {{smsError ? 'error' : ''}}"
          type="number"
          placeholder="è¯·è¾“å…¥6ä½éªŒè¯ç " 
          value="{{formData.smsCode}}"
          bindinput="onInputSmsCode"
          maxlength="6"
        />
        <button 
          class="sms-btn {{canSendSMS ? 'active' : 'disabled'}}" 
          bindtap="onSendSMS" 
          disabled="{{!canSendSMS}}"
        >
          {{smsText}}
        </button>
      </view>
      <view wx:if="{{smsError}}" class="error-tip">{{smsError}}</view>
      <!-- å¼€å‘æ¨¡å¼éªŒè¯ç æ˜¾ç¤º -->
      <view wx:elif="{{devSmsCode}}" class="dev-sms-tip">
        <text class="dev-tip-text">å¼€å‘æ¨¡å¼éªŒè¯ç : {{devSmsCode}}</text>
      </view>
    </view>

  </view>

  <!-- æäº¤æŒ‰é’® -->
  <view class="submit-section">
    <button 
      class="submit-btn {{canSubmit ? 'active' : 'disabled'}}" 
      bindtap="onSubmit"
      disabled="{{!canSubmit || submitting}}"
    >
      {{submitting ? submitText : 'å®Œæˆç™»è®°'}}
    </button>
  </view>

  <!-- æˆåŠŸçŠ¶æ€å¼¹çª— -->
  <view wx:if="{{showSuccess}}" class="success-modal">
    <view class="success-content">
      <view class="success-icon">âœ…</view>
      <view class="success-title">{{successTitle}}</view>
      <view class="success-desc">{{successDesc}}</view>
      <view wx:if="{{showDoorStatus}}" class="door-status">
        <view class="door-loading">
          <view class="loading-spinner"></view>
          <text>æ­£åœ¨å¼€é—¨...</text>
        </view>
      </view>
    </view>
  </view>
</view> 