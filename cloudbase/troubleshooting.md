# 访客登记问题排查指南

## 🐛 问题1: 字体加载错误

**错误信息**: `Failed to load font https://tdesign.gtimg.com/icon/0.3.2/fonts/t.woff`

### ✅ 解决方案
已在 `miniprogram/app.wxss` 中添加字体配置，这个错误不影响功能使用。

```wxss
/* 解决TDesign图标字体加载问题 */
@font-face {
  font-family: 't-icon';
  src: url('https://tdesign.gtimg.com/icon/0.3.2/fonts/t.woff2') format('woff2'),
       url('https://tdesign.gtimg.com/icon/0.3.2/fonts/t.woff') format('woff'),
       url('https://tdesign.gtimg.com/icon/0.3.2/fonts/t.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}
```

## 🐛 问题2: 完成登记按钮无法点击

### 📋 排查步骤

1. **打开开发者工具调试面板**
2. **进入访客登记页面**
3. **查看控制台日志**

### 🔍 调试信息
现在会在控制台显示详细的表单验证信息：
- 初始表单数据
- 每次输入的验证结果
- 最终的canSubmit状态

### 🧪 测试流程

#### 方式1: 微信获取手机号
1. ✅ 填写姓名：`张三`
2. ✅ 选择性别：`男`
3. ✅ 输入年龄：`25`
4. ✅ 点击"微信获取"按钮获取手机号
5. ✅ 按钮应该变亮可点击

#### 方式2: 手动输入手机号
1. ✅ 填写姓名：`李四`
2. ✅ 选择性别：`女`
3. ✅ 输入年龄：`30`
4. ✅ 输入手机号：`13800138000`
5. ✅ 按钮应该变亮可点击（可以先提交，系统会提示发送验证码）

### 🔧 修复要点

1. **基础验证**: 姓名、性别、年龄、有效手机号
2. **手机号验证**: 必须是11位有效手机号
3. **验证码**: 仅在手动输入且已发送短信时才需要

### 🚨 常见问题

#### 按钮还是灰色？
检查控制台日志，查看哪个字段验证失败：
- `name`: 姓名不能为空
- `gender`: 必须选择性别
- `age`: 年龄必须是数字
- `phone`: 手机号格式不正确
- `phoneValid`: 手机号验证失败

#### 手机号验证失败？
确保手机号格式正确：
- 必须以1开头
- 第二位是3-9
- 总共11位数字

### 📱 测试用例

```javascript
// 有效的手机号
✅ 13800138000
✅ 15912345678
✅ 18612345678

// 无效的手机号
❌ 12345678901 (第二位不是3-9)
❌ 1380013800 (只有10位)
❌ 138001380001 (超过11位)
```

### 🔄 重新测试

1. **重启小程序**
2. **清除开发者工具缓存**
3. **按照测试流程重新操作**
4. **观察控制台日志**

### 💡 快速修复

如果问题依然存在，可以临时设置：

```javascript
// 在 pages/register/index.js 的 onLoad 中添加
onLoad() {
  this.validateForm();
  
  // 临时强制启用按钮（仅用于测试）
  // this.setData({ canSubmit: true });
},
```

⚠️ **注意**: 仅用于测试，完成测试后请删除此行。 