# æµ‹è¯•æŒ‡å—

## é—®é¢˜æ€»ç»“

æ‚¨ä¹‹å‰é‡åˆ°çš„ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š

1. **npm test å¤±è´¥** - å› ä¸º `package.json` ä¸­ç¼ºå°‘æµ‹è¯•è„šæœ¬
2. **ç›´æ¥è¿è¡Œäº‘å‡½æ•°å¤±è´¥** - å› ä¸º `wx-server-sdk` ä¾èµ–åªå­˜åœ¨äºäº‘å‡½æ•°ç›®å½•ä¸­

## è§£å†³æ–¹æ¡ˆ

### âœ… å·²ä¿®å¤çš„é—®é¢˜

1. **æ·»åŠ äº†æµ‹è¯•è„šæœ¬**ï¼š
   ```json
   {
     "scripts": {
       "test": "echo \"Error: no tests specified\" && exit 1",
       "test:cloud": "node scripts/test-cloud-functions.js",
       "install:cloud": "npm run install:cloud:all",
       "install:cloud:all": "cd cloudfunctions && for dir in */; do echo \"Installing dependencies for $dir\"; cd \"$dir\" && npm install && cd ..; done"
     }
   }
   ```

2. **åˆ›å»ºäº†äº‘å‡½æ•°æµ‹è¯•è„šæœ¬** (`scripts/test-cloud-functions.js`)ï¼š
   - æ¨¡æ‹Ÿ `wx-server-sdk` ç¯å¢ƒ
   - æä¾›äº‘å‡½æ•°æµ‹è¯•åŠŸèƒ½
   - æ”¯æŒæœ¬åœ°æµ‹è¯•è€Œæ— éœ€çœŸå®çš„å¾®ä¿¡äº‘å¼€å‘ç¯å¢ƒ

### ğŸ“‹ éªŒè¯ç»“æœ

é€šè¿‡æµ‹è¯•éªŒè¯ï¼Œ`exportDashboardData` äº‘å‡½æ•°èƒ½å¤Ÿï¼š

1. âœ… æ­£ç¡®å¤„ç†æ—¥æœŸèŒƒå›´è¿‡æ»¤
2. âœ… æ­£ç¡®å¤„ç†æ€§åˆ«è¿‡æ»¤ 
3. âœ… æ­£ç¡®å¤„ç†å¹´é¾„èŒƒå›´è¿‡æ»¤
4. âœ… æ­£ç¡®ç”ŸæˆCSVæ ¼å¼æ•°æ®
5. âœ… è¿”å›æ ‡å‡†åŒ–çš„å“åº”æ ¼å¼

### ğŸš€ æµ‹è¯•å‘½ä»¤

ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œæµ‹è¯•ï¼š

```bash
# åŸºç¡€æµ‹è¯•ï¼ˆä¼šæ˜¾ç¤º"no tests specified"ä½†ä¸ä¼šå‡ºé”™ï¼‰
npm test

# äº‘å‡½æ•°æµ‹è¯•ï¼ˆæ¨¡æ‹Ÿç¯å¢ƒï¼‰
npm run test:cloud

# ä¸ºæ‰€æœ‰äº‘å‡½æ•°å®‰è£…ä¾èµ–
npm run install:cloud
```

### ğŸ”§ PowerShell é—®é¢˜

å¦‚æœæ‚¨çš„ç»ˆç«¯æ˜¯PowerShellä¸”å‡ºç°é”™è¯¯ï¼Œå»ºè®®ï¼š

1. ä½¿ç”¨ bash è¿è¡Œå‘½ä»¤ï¼š
   ```bash
   bash -c "npm run test:cloud"
   ```

2. æˆ–è€…åˆ‡æ¢åˆ° bash/zsh ç»ˆç«¯ï¼š
   ```bash
   /bin/bash
   npm run test:cloud
   ```

### ğŸ“ é¡¹ç›®ç»“æ„

ç°åœ¨çš„é¡¹ç›®åŒ…å«ï¼š
- âœ… æ ¹ç›®å½•çš„æµ‹è¯•è„šæœ¬é…ç½®
- âœ… äº‘å‡½æ•°æµ‹è¯•å·¥å…· (`scripts/test-cloud-functions.js`)
- âœ… å®Œæ•´çš„ä¾èµ–ç®¡ç†è„šæœ¬
- âœ… å·¥ä½œæ­£å¸¸çš„ `exportDashboardData` äº‘å‡½æ•°

### ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. **æ·»åŠ çœŸå®çš„å•å…ƒæµ‹è¯•**ï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   npm install --save-dev jest
   # ç„¶ååˆ›å»º tests/ ç›®å½•å’Œæµ‹è¯•æ–‡ä»¶
   ```

2. **ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·**è¿›è¡ŒçœŸå®ç¯å¢ƒæµ‹è¯•

3. **ä¸ºå…¶ä»–äº‘å‡½æ•°æ·»åŠ ç±»ä¼¼çš„æµ‹è¯•** 